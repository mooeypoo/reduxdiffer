<html>
	<head>
		<script type="text/javascript" src="lib/jquery-3.2.1.js"></script>
<!-- OOJS UI -->
		<script type="text/javascript" src="node_modules/oojs/dist/oojs.jquery.js"></script>
		<script type="text/javascript" src="node_modules/oojs-ui/dist/oojs-ui-core.js"></script>
		<script type="text/javascript" src="node_modules/oojs-ui/dist/oojs-ui-wikimediaui.js"></script>
		<link rel="stylesheet" type="text/css" href="node_modules/oojs-ui/dist/oojs-ui-wikimediaui.css"/>
<!-- REDUX + DIFFER -->
		<script type="text/javascript" src="node_modules/redux/dist/redux.min.js"></script>
		<script type="text/javascript" src="dist/redux.js"></script>

		<script>
			$( document ).ready( function () {
				var initialState = diff.reduxController.getState(),
					visibilityButton = new OO.ui.ButtonWidget( {
						label: 'Visibility: ' + initialState.visibilityFilter
					} ),
					visibilityFilterNames = [ 'all', 'completed', 'ongoing' ]
					filterIndex = 1;

				// HACK: This is just for a quick test to see if we can get the button
				// to update itself properly on state changes
				visibilityButton.updateLabel = function () {
					this.setLabel( 'Visibility: ' + diff.reduxController.getState().visibilityFilter )
				}

				// Register the button for changes in visibilityFilter
				diff.reduxController.subscribe(
					visibilityButton,
					[ 'visibilityFilter'],
					'updateLabel' // Method
				);

				// Register button click event to change the state
				visibilityButton.on( 'click', function () {
					console.log( 'visibilityButton click', visibilityFilterNames[ filterIndex ]);
					diff.reduxController.setVisibilityFilter( visibilityFilterNames[ filterIndex ] );

					// For demo purposes, rotate around the values
					filterIndex = ( filterIndex + 1 ) % visibilityFilterNames.length;
				} );

				// Attach to DOM
				$( '.wrapper' ).append( visibilityButton.$element );
				console.log( 'initialState', initialState );
			} );
		</script>
	</head>
<body>
	<h1>OOJS-UI with Redux</h1>
	<div class='wrapper'></div>
</body>
</html>
